{% extends "base.html" %}
{% block title %}Búsqueda: {{ query }} - Tienda Virtual{% endblock %}
{% block content %}
<h2 class="mb-4">
    Resultados para: "{{ query }}"
    {% if use_ai %}
    <span class="badge bg-primary ms-2">
        <i class="fas fa-robot"></i> Búsqueda inteligente
    </span>
    {% endif %}
</h2>
<p class="text-muted">{{ productos.total }} productos encontrados</p>

{% if intencion_usuario %}
<div class="alert alert-info mb-4">
    <i class="fas fa-lightbulb"></i> <strong>Entendí que buscas:</strong> {{ intencion_usuario }}
</div>
{% endif %}

{% if sugerencias_busqueda %}
<div class="mb-4">
    <p class="mb-2"><i class="fas fa-search"></i> <strong>También podrías buscar:</strong></p>
    <div class="d-flex flex-wrap gap-2">
        {% for sugerencia in sugerencias_busqueda %}
        <a href="{{ url_for('shop.search', q=sugerencia) }}" class="btn btn-sm btn-outline-secondary">
            {{ sugerencia }}
        </a>
        {% endfor %}
    </div>
</div>
{% endif %}
{% if productos.items %}
<div class="row">
    {% for producto in productos.items %}
    <div class="col-md-3 mb-4">
        {% include 'components/product_card.html' %}
    </div>
    {% endfor %}
</div>
{% if productos.pages > 1 %}
<nav><ul class="pagination">
    <li class="page-item {% if not productos.has_prev %}disabled{% endif %}">
        <a class="page-link" href="{{ url_for('shop.search', q=query, page=productos.prev_num) }}">Anterior</a>
    </li>
    {% for page in productos.iter_pages() %}
    <li class="page-item {% if page == productos.page %}active{% endif %}">
        <a class="page-link" href="{{ url_for('shop.search', q=query, page=page) }}">{{ page }}</a>
    </li>
    {% endfor %}
    <li class="page-item {% if not productos.has_next %}disabled{% endif %}">
        <a class="page-link" href="{{ url_for('shop.search', q=query, page=productos.next_num) }}">Siguiente</a>
    </li>
</ul></nav>
{% endif %}
{% else %}
<div class="alert alert-info"><i class="fas fa-info-circle"></i> No se encontraron productos</div>
{% endif %}
{% endblock %}
